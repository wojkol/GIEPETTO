<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat with AI</title>
    
    <script>
        let session_id = localStorage.getItem("session_id") || null;

async function sendMessage() {
    let userInput = document.getElementById("user-input").value;
    if (!userInput.trim()) return;

    // Display user message
    let chatBox = document.getElementById("chat-box");
    chatBox.innerHTML += `<p><strong>You:</strong> ${userInput}</p>`;
    document.getElementById("user-input").value = "";

    // Send message to Django backend (Make sure it's POST)
    let response = await fetch("/api/chat/", {
        method: "POST",  // Ensure this is POST, not GET
        headers: {
            "Content-Type": "application/json",
        },
        body: JSON.stringify({ message: userInput, session_id: session_id })
    });

    let data = await response.json();
    session_id = data.session_id;  // Store session ID for continuity
    localStorage.setItem("session_id", session_id);

    // Display AI response
    chatBox.innerHTML += `<p><strong>AI:</strong> ${data.ai_message}</p>`;
}


    </script>
</head>
<body>
    <h1>Chat with AI</h1>
    <div id="chat-box" style="border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: scroll;"></div>
    <input type="text" id="user-input" placeholder="Type a message...">
    <button onclick="sendMessage()">Send</button>
</body>
</html>
